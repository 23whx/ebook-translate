# 🌍 语言检测和双语对照模式使用说明

## ✨ 新功能概述

### 功能 1：智能语言检测 🔍
- ✅ 自动检测原书语言
- ✅ 支持 16 种主流语言
- ✅ 智能提示和验证

### 功能 2：单语/双语对照模式 📖
- ✅ 单语模式：只显示译文
- ✅ 双语模式：原文和译文对照
- ✅ 灵活的阅读体验

---

## 🔍 语言检测功能

### 支持的语言

| 语言 | 语言代码 | 本地名称 |
|------|----------|----------|
| 中文 | zh | 中文 |
| 中文（简体）| zh-CN | 简体中文 |
| 中文（繁体）| zh-TW | 繁體中文 |
| 英语 | en | English |
| 日语 | ja | 日本語 |
| 韩语 | ko | 한국어 |
| 法语 | fr | Français |
| 德语 | de | Deutsch |
| 西班牙语 | es | Español |
| 俄语 | ru | Русский |
| 意大利语 | it | Italiano |
| 葡萄牙语 | pt | Português |
| 阿拉伯语 | ar | العربية |
| 印地语 | hi | हिन्दी |
| 泰语 | th | ไทย |
| 越南语 | vi | Tiếng Việt |

### 检测原理

系统通过以下方式检测语言：

1. **字符特征分析**
   - 检测特殊字符（汉字、假名、韩文、西里尔字母等）
   - 统计各类字符出现频率

2. **常用词匹配**
   - 对于拉丁字母语言（英法德西意葡）
   - 匹配常用词来区分具体语言

3. **多章节综合判断**
   - 检测前 3 章内容
   - 取最常见的语言作为结果

### 使用方法

#### 自动检测

上传 EPUB 后，系统会自动检测：

```
1. 上传 EPUB 文件
2. 解析章节完成
3. 自动检测语言 ✅
4. 在"翻译设置"中看到：
   "源语言 (已自动检测: 英语 English)"
```

#### 手动调整

如果检测不准确，可以手动选择：

```
1. 展开"⚙️ 翻译设置"
2. 在"源语言"下拉框中选择正确的语言
3. 看到警告："⚠️ 选择的语言与检测结果不同"
4. 确认后继续翻译
```

### 检测示例

#### 示例 1：英文书籍

**原文**：
```
The quick brown fox jumps over the lazy dog. 
Machine learning is a subset of artificial intelligence.
```

**检测结果**：
```
✅ 检测到: 英语 (English)
   - 拉丁字母: 高频
   - 常用词匹配: the, a, is, of
```

#### 示例 2：中文书籍

**原文**：
```
机器学习是人工智能的一个子集。
深度学习在计算机视觉领域取得了重大突破。
```

**检测结果**：
```
✅ 检测到: 中文 (中文)
   - 汉字: 高频
   - 无假名或韩文字母
```

#### 示例 3：日文书籍

**原文**：
```
機械学習は人工知能の一部です。
ディープラーニングは画像認識に使われます。
```

**检测结果**：
```
✅ 检测到: 日语 (日本語)
   - 汉字: 存在
   - 假名: 高频 (ディープラーニング)
```

#### 示例 4：法文书籍

**原文**：
```
Le machine learning est un sous-ensemble de l'intelligence artificielle.
```

**检测结果**：
```
✅ 检测到: 法语 (Français)
   - 拉丁字母: 高频
   - 常用词匹配: le, est, de, un
```

---

## 📖 单语/双语对照模式

### 模式对比

| 特性 | 单语模式 | 双语对照模式 |
|------|----------|--------------|
| 内容 | 只有译文 | 原文 + 译文 |
| 文件大小 | 小 | 约 2 倍 |
| 适合场景 | 纯阅读 | 学习、对照 |
| 章节数量 | 原章节数 | 原章节数 × 2 |
| 排版方式 | 直接替换 | 交替显示 |

### 单语模式

#### 适用场景

✅ **纯粹阅读译本**
- 只想看译文
- 不需要对照原文
- 文件体积小

✅ **分享给他人**
- 接收者不懂原文语言
- 只需要译文版本

#### 章节结构

```
📖 The Laws of Human Nature (翻译版).epub
   ├─ 第1章 (译文)
   ├─ 第2章 (译文)
   ├─ 第3章 (译文)
   └─ ...
```

#### 示例效果

**原书**（英文）：
```
Chapter 1: Introduction
This book explores the fundamental laws of human nature...
```

**单语模式导出后**（中文）：
```
第1章：引言
本书探讨人性的基本法则...
```

### 双语对照模式

#### 适用场景

✅ **语言学习**
- 对照原文学习
- 理解翻译质量
- 学习表达方式

✅ **专业研究**
- 需要参考原文
- 验证翻译准确性
- 学术引用

✅ **翻译审校**
- 检查翻译质量
- 对照原文修改
- 专业翻译工作

#### 章节结构

```
📖 The Laws of Human Nature (双语版).epub
   ├─ 第1章 (原文)     ← 英文
   ├─ 第1章 (译文)     ← 中文
   ├─ 第2章 (原文)     ← 英文
   ├─ 第2章 (译文)     ← 中文
   ├─ 第3章 (原文)     ← 英文
   ├─ 第3章 (译文)     ← 中文
   └─ ...
```

#### 示例效果

**页面 1**（原文）：
```
Chapter 1: Introduction (原文)

This book explores the fundamental laws of human nature.
Understanding these laws can help us navigate social 
situations more effectively.
```

**页面 2**（译文）：
```
第1章：引言 (译文)

本书探讨人性的基本法则。
理解这些法则可以帮助我们更有效地应对社交情境。
```

**页面 3**（原文）：
```
Chapter 2: The Law of Irrationality (原文)

Humans are not as rational as we think...
```

**页面 4**（译文）：
```
第2章：非理性法则 (译文)

人类并不像我们想象的那样理性...
```

---

## 🎯 使用教程

### 场景 1：英译中（单语模式）

```
步骤：
1. 上传英文 EPUB
2. 系统检测：✅ 英语 (English)
3. 选择目标语言：中文
4. 翻译所有章节
5. 导出页面选择：⚫ 单语模式
6. 下载：book_translated.epub（只有中文）
```

### 场景 2：英译中（双语对照）

```
步骤：
1. 上传英文 EPUB
2. 系统检测：✅ 英语 (English)
3. 选择目标语言：中文
4. 翻译所有章节
5. 导出页面选择：⚫ 双语对照模式
6. 下载：book_bilingual.epub（英文+中文对照）
```

### 场景 3：日译中（学习用）

```
用例：学习日语，想对照中文理解

步骤：
1. 上传日文轻小说 EPUB
2. 系统检测：✅ 日语 (日本語)
3. 选择目标语言：中文
4. 翻译所有章节
5. 导出选择：⚫ 双语对照模式
6. 在电子书阅读器中：
   - 第1页：日文原文 → 学习
   - 第2页：中文译文 → 理解
   - 第3页：日文原文 → 继续学习
```

### 场景 4：中译英（分享给外国朋友）

```
用例：中文小说翻译成英文送给美国朋友

步骤：
1. 上传中文小说 EPUB
2. 系统检测：✅ 中文 (中文)
3. 选择目标语言：英语 (English)
4. 翻译所有章节
5. 导出选择：⚫ 单语模式
6. 下载：novel_translated.epub（只有英文）
7. 发送给朋友（他们只看到英文）
```

---

## ⚙️ 在导出页面选择模式

### 导出页面界面

```
┌─────────────────────────────────────────────┐
│ 📖 选择输出模式                             │
│                                             │
│ ⚫ 单语模式                                 │
│    只保留译文，替换原文。适合阅读译本。    │
│                                             │
│ ◯ 双语对照模式                             │
│    保留原文和译文。第一页原文，第二页      │
│    译文，交替显示。适合对照学习。          │
│                                             │
│              [📥 下载翻译后的 EPUB]         │
└─────────────────────────────────────────────┘
```

### 选择建议

#### 选择单语模式 ⚫

- ✅ 只想读译文
- ✅ 不需要原文
- ✅ 文件要小一点
- ✅ 给不懂原文语言的人

#### 选择双语对照 ⚫

- ✅ 语言学习
- ✅ 对照阅读
- ✅ 翻译研究
- ✅ 保留原文参考

---

## 💡 高级用法

### 技巧 1：多语言翻译

可以翻译成任意支持的语言：

```
英文 → 中文 ✅
英文 → 日文 ✅
中文 → 英文 ✅
日文 → 韩文 ✅
法文 → 德文 ✅
...（任意语言对）
```

### 技巧 2：语言学习路径

**初学者**：
```
1. 上传目标语言的书
2. 翻译成母语
3. 选择双语模式
4. 对照学习
```

**中级者**：
```
1. 上传母语的书
2. 翻译成目标语言
3. 选择双语模式
4. 检查翻译学习表达
```

### 技巧 3：专业翻译工作流

```
1. 接到翻译项目
2. 上传原文 EPUB
3. AI 初译
4. 人工审校确认
5. 导出双语版（客户审核用）
6. 修改后导出单语版（最终交付）
```

### 技巧 4：家庭共享

```
一本英文书，全家都能读：

1. 上传英文原版
2. 翻译成中文
3. 导出两个版本：
   - 单语版（给只读中文的家人）
   - 双语版（给想学英语的家人）
```

---

## 📊 文件大小对比

### 示例：300 页小说

| 模式 | 文件大小 | 章节数 | 说明 |
|------|----------|--------|------|
| 原版 | 2.5 MB | 20 章 | 只有英文 |
| 单语版 | 2.8 MB | 20 章 | 只有中文 |
| 双语版 | 5.0 MB | 40 章 | 英文+中文 |

### 说明

- **单语版**：略大于原版（因为中文字符）
- **双语版**：约 2 倍大小（包含两份内容）
- **实际大小**：取决于原书内容和图片

---

## ❓ 常见问题

### Q1: 语言检测不准确怎么办？

**A:** 手动选择即可：
```
1. 展开"翻译设置"
2. 在"源语言"下拉框选择正确的语言
3. 系统会提示与检测结果不同
4. 忽略警告，继续翻译
```

### Q2: 为什么双语版文件这么大？

**A:** 因为包含了两份内容：
- 原文完整内容
- 译文完整内容
- 相当于两本书合成一本

### Q3: 双语模式在电子书阅读器中怎么显示？

**A:** 
- 目录会显示：第1章(原文)、第1章(译文)、第2章(原文)...
- 阅读时翻页：原文 → 译文 → 原文 → 译文
- 可以使用目录直接跳转

### Q4: 可以只看原文或译文吗（双语版中）？

**A:** 可以的：
- 大多数阅读器支持目录跳转
- 原文和译文分开显示
- 可以选择性阅读

### Q5: 支持所有语言互译吗？

**A:** 理论上支持，但质量取决于：
- TranslateGemma 模型的训练数据
- 常见语言对质量更高（如英中、英日）
- 小语种之间可能质量较低

### Q6: 检测繁简中文准确吗？

**A:** 
- 系统主要检测"中文"
- 不特别区分简繁体
- 建议手动选择 zh-CN 或 zh-TW

### Q7: 混合语言的书怎么办？

**A:** 
- 系统取最常见的语言
- 建议手动确认
- 或者按主要语言处理

---

## 🎓 最佳实践

### 推荐工作流程

#### 纯阅读用户

```
1. 上传外文书 → 自动检测语言 ✅
2. 选择目标语言（母语）
3. 批量翻译
4. 导出：⚫ 单语模式
5. 享受阅读！
```

#### 语言学习者

```
1. 上传学习材料 → 自动检测 ✅
2. 翻译成母语
3. 审校确认
4. 导出：⚫ 双语对照模式
5. 对照学习！
```

#### 专业译者

```
1. 接收项目 → 检测语言 ✅
2. 确认语言对
3. AI 初译 + 术语表
4. 逐章审校
5. 导出双语版供客户审核
6. 修改后导出单语版交付
```

---

## 🎉 功能亮点

### 智能检测

- ✅ 16 种语言自动识别
- ✅ 多章节综合判断
- ✅ 智能提示和验证

### 灵活输出

- ✅ 单语/双语自由选择
- ✅ 适配不同使用场景
- ✅ 专业排版布局

### 用户友好

- ✅ 自动化程度高
- ✅ 手动调整灵活
- ✅ 清晰的模式说明

---

**现在您可以翻译任何语言的书籍，并选择最适合的输出模式！** 🌍📚✨

*最后更新: 2026-01-20*
*版本: 2.0*
